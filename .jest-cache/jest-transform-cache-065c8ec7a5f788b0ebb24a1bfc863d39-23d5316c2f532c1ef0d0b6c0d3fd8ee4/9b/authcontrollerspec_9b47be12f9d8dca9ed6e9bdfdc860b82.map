{"file":"/home/omar/Desktop/Protofolio_without_redis/src/auth/auth.controller.spec.ts","mappings":";;AAAA,4DAA4D;AAC5D,0DAA0D;AAC1D,+DAA+D;AAC/D,sDAAsD;AACtD,6CAAsD;AACtD,iDAAoD;AACpD,uDAAmD;AACnD,iDAA6C;AAU7C,2CAAmD;AAEnD,2CAA+C;AAE/C,QAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE;IAC9B,IAAI,UAA0B,CAAC;IAC/B,IAAI,WAAwB,CAAC;IAE7B,UAAU,CAAC,KAAK,IAAI,EAAE;QACpB,MAAM,MAAM,GAAkB,MAAM,cAAI,CAAC,mBAAmB,CAAC;YAC3D,OAAO,EAAE;gBACP,2BAAe,CAAC,OAAO,CAAC;oBACtB,UAAU,EAAE,CAAC,EAAE,GAAG,EAAE,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,CAAC;iBACrC,CAAC;aACH;YACD,WAAW,EAAE,CAAC,gCAAc,CAAC;YAC7B,SAAS,EAAE;gBACT;oBACE,OAAO,EAAE,0BAAW;oBACpB,QAAQ,EAAE;wBACR,aAAa,EAAE,IAAI,CAAC,EAAE,EAAE;wBACxB,aAAa,EAAE,IAAI,CAAC,EAAE,EAAE;wBACxB,iBAAiB,EAAE,IAAI,CAAC,EAAE,EAAE;wBAC5B,KAAK,EAAE,IAAI,CAAC,EAAE,EAAE;wBAChB,OAAO,EAAE,IAAI,CAAC,EAAE,EAAE;wBAClB,oBAAoB,EAAE,IAAI,CAAC,EAAE,EAAE;wBAC/B,oBAAoB,EAAE,IAAI,CAAC,EAAE,EAAE;wBAC/B,kBAAkB,EAAE,IAAI,CAAC,EAAE,EAAE;wBAC7B,YAAY,EAAE,IAAI,CAAC,EAAE,EAAE;qBACxB;iBACF;gBACD;oBACE,OAAO,EAAE,sBAAa;oBACtB,QAAQ,EAAE;wBACR,GAAG,EAAE,IAAI,CAAC,EAAE,EAAE;qBACf;iBACF;aACF;SACF,CAAC,CAAC,OAAO,EAAE,CAAC;QAEb,UAAU,GAAG,MAAM,CAAC,GAAG,CAAiB,gCAAc,CAAC,CAAC;QACxD,WAAW,GAAG,MAAM,CAAC,GAAG,CAAc,0BAAW,CAAC,CAAC;IACrD,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,mBAAmB,EAAE,GAAG,EAAE;QAC3B,MAAM,CAAC,UAAU,CAAC,CAAC,WAAW,EAAE,CAAC;IACnC,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,eAAe,EAAE,GAAG,EAAE;QAC7B,EAAE,CAAC,iEAAiE,EAAE,KAAK,IAAI,EAAE;YAC/E,MAAM,GAAG,GAAoB,EAAE,KAAK,EAAE,kBAAkB,EAAE,CAAC;YAC3D,MAAM,GAAG,GAAG,EAAE,EAAE,EAAE,WAAW,EAAE,MAAM,EAAE,EAAE,EAAa,CAAC;YACtD,WAAW,CAAC,aAA2B,CAAC,iBAAiB,CAAC;gBACzD,OAAO,EAAE,IAAI;aACd,CAAC,CAAC;YAEH,MAAM,MAAM,GAAG,MAAM,UAAU,CAAC,aAAa,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;YACxD,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,oBAAoB,CACpD,kBAAkB,EAClB,WAAW,CACZ,CAAC;YACF,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;QAC5C,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,eAAe,EAAE,GAAG,EAAE;QAC7B,EAAE,CAAC,2DAA2D,EAAE,KAAK,IAAI,EAAE;YACzE,MAAM,GAAG,GAAoB,EAAE,KAAK,EAAE,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC;YAClE,MAAM,GAAG,GAAG,EAAE,EAAE,EAAE,SAAS,EAAE,MAAM,EAAE,EAAE,EAAa,CAAC;YACpD,WAAW,CAAC,aAA2B,CAAC,iBAAiB,CAAC;gBACzD,OAAO,EAAE,IAAI;aACd,CAAC,CAAC;YAEH,MAAM,MAAM,GAAG,MAAM,UAAU,CAAC,aAAa,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;YACxD,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,oBAAoB,CACpD,SAAS,EACT,QAAQ,EACR,SAAS,CACV,CAAC;YACF,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;QAC5C,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IACH,QAAQ,CAAC,mBAAmB,EAAE,GAAG,EAAE;QACjC,IAAI,YAAiB,CAAC;QAEtB,UAAU,CAAC,GAAG,EAAE;YACd,YAAY,GAAG;gBACb,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;gBACjB,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE,EAAE,UAAU;gBAC3B,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE,EAAE,sCAAsC;aAC3E,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,kFAAkF,EAAE,KAAK,IAAI,EAAE;YAChG,MAAM,GAAG,GAAwB,EAAE,KAAK,EAAE,SAAS,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC;YACvE,WAAW,CAAC,iBAA+B,CAAC,iBAAiB,CAAC;gBAC7D,aAAa,EAAE,sBAAsB;gBACrC,YAAY,EAAE,cAAc;aAC7B,CAAC,CAAC;YAEH,MAAM,UAAU,CAAC,iBAAiB,CAAC,GAAG,EAAE,YAAY,CAAC,CAAC;YAEtD,MAAM,CAAC,WAAW,CAAC,iBAAiB,CAAC,CAAC,oBAAoB,CACxD,SAAS,EACT,MAAM,CACP,CAAC;YAEF,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,oBAAoB,CAC9C,cAAc,EACd,sBAAsB,EACtB,MAAM,CAAC,gBAAgB,CAAC;gBACtB,QAAQ,EAAE,KAAK;gBACf,MAAM,EAAE,IAAI;gBACZ,QAAQ,EAAE,QAAQ;gBAClB,IAAI,EAAE,eAAe;aACtB,CAAC,CACH,CAAC;YAEF,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,oBAAoB,CAC5C,MAAM,CAAC,gBAAgB,CAAC;gBACtB,OAAO,EAAE,IAAI;gBACb,OAAO,EAAE,SAAS;gBAClB,IAAI,EAAE,MAAM,CAAC,gBAAgB,CAAC;oBAC5B,YAAY,EAAE,cAAc;iBAC7B,CAAC;aACH,CAAC,CACH,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,4DAA4D,EAAE,KAAK,IAAI,EAAE;YAC1E,MAAM,GAAG,GAAwB,EAAE,KAAK,EAAE,SAAS,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC;YACvE,WAAW,CAAC,iBAA+B,CAAC,iBAAiB,CAAC;gBAC7D,aAAa,EAAE,SAAS;gBACxB,YAAY,EAAE,cAAc;aAC7B,CAAC,CAAC;YAEH,MAAM,MAAM,CACV,UAAU,CAAC,iBAAiB,CAAC,GAAG,EAAE,YAAY,CAAC,CAChD,CAAC,OAAO,CAAC,OAAO,CAAC,0BAAiB,CAAC,CAAC;QACvC,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,2DAA2D,EAAE,KAAK,IAAI,EAAE;YACzE,MAAM,GAAG,GAAwB,EAAE,KAAK,EAAE,SAAS,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC;YACvE,WAAW,CAAC,iBAA+B,CAAC,iBAAiB,CAAC;gBAC7D,aAAa,EAAE,sBAAsB;gBACrC,YAAY,EAAE,SAAS;aACxB,CAAC,CAAC;YAEH,MAAM,MAAM,CACV,UAAU,CAAC,iBAAiB,CAAC,GAAG,EAAE,YAAY,CAAC,CAChD,CAAC,OAAO,CAAC,OAAO,CAAC,0BAAiB,CAAC,CAAC;QACvC,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,OAAO,EAAE,GAAG,EAAE;QACrB,EAAE,CAAC,oEAAoE,EAAE,KAAK,IAAI,EAAE;YAClF,MAAM,GAAG,GAAa,EAAE,KAAK,EAAE,SAAS,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;YAC5D,MAAM,GAAG,GAAG;gBACV,EAAE,EAAE,SAAS;gBACb,MAAM,EAAE,EAAE,aAAa,EAAE,SAAS,EAAE;aACf,CAAC;YAExB,MAAM,GAAG,GAAG;gBACV,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;gBACjB,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE;aACO,CAAC;YAEzB,MAAM,UAAU,GAAG;gBACjB,YAAY,EAAE,oBAAoB;gBAClC,aAAa,EAAE,qBAAqB;aACrC,CAAC;YAED,WAAW,CAAC,KAAmB,CAAC,iBAAiB,CAAC,UAAU,CAAC,CAAC;YAE/D,MAAM,UAAU,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;YAEtC,4BAA4B;YAC5B,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,oBAAoB,CAC5C,SAAS,EACT,KAAK,EACL,SAAS,CACV,CAAC;YACF,yBAAyB;YACzB,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,oBAAoB,CACrC,cAAc,EACd,qBAAqB,EACrB;gBACE,QAAQ,EAAE,KAAK;gBACf,MAAM,EAAE,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY;gBAC7C,QAAQ,EAAE,QAAQ;gBAClB,IAAI,EAAE,eAAe;gBACrB,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI;aAChC,CACF,CAAC;YAEF,0CAA0C;YAC1C,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,oBAAoB,CACnC,MAAM,CAAC,gBAAgB,CAAC;gBACtB,OAAO,EAAE,IAAI;gBACb,OAAO,EAAE,SAAS;gBAClB,IAAI,EAAE,EAAE,YAAY,EAAE,oBAAoB,EAAE;aAC7C,CAAC,CACH,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,4DAA4D,EAAE,KAAK,IAAI,EAAE;YAC1E,MAAM,GAAG,GAAa,EAAE,KAAK,EAAE,SAAS,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;YAC5D,MAAM,GAAG,GAAG;gBACV,EAAE,EAAE,SAAS;gBACb,MAAM,EAAE,EAAE,aAAa,EAAE,SAAS,EAAE;aACf,CAAC;YACxB,MAAM,GAAG,GAAG,EAAc,CAAC;YAE1B,WAAW,CAAC,KAAmB,CAAC,iBAAiB,CAAC;gBACjD,YAAY,EAAE,oBAAoB;gBAClC,aAAa,EAAE,SAAS;aACzB,CAAC,CAAC;YAEH,MAAM,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAC3D,0BAAiB,CAClB,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,2DAA2D,EAAE,KAAK,IAAI,EAAE;YACzE,MAAM,GAAG,GAAa,EAAE,KAAK,EAAE,SAAS,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;YAC5D,MAAM,GAAG,GAAG;gBACV,EAAE,EAAE,SAAS;gBACb,MAAM,EAAE,EAAE,aAAa,EAAE,SAAS,EAAE;aACf,CAAC;YACxB,MAAM,GAAG,GAAG,EAAc,CAAC;YAE1B,WAAW,CAAC,KAAmB,CAAC,iBAAiB,CAAC;gBACjD,YAAY,EAAE,SAAS;gBACvB,aAAa,EAAE,qBAAqB;aACrC,CAAC,CAAC;YAEH,MAAM,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAC3D,0BAAiB,CAClB,CAAC;QACJ,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,SAAS,EAAE,GAAG,EAAE;QACvB,EAAE,CAAC,oDAAoD,EAAE,KAAK,IAAI,EAAE;YAClE,MAAM,YAAY,GAAG;gBACnB,OAAO,EAAE,IAAI;gBACb,OAAO,EAAE,yBAAyB;aACnC,CAAC;YACD,WAAW,CAAC,OAAqB,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;YAEnE,MAAM,GAAG,GAAG;gBACV,KAAK,EAAE,kBAAkB;gBACzB,aAAa,EAAE,oBAAoB;aACpC,CAAC;YAEF,MAAM,MAAM,GAAG,MAAM,UAAU,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;YAE7C,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,oBAAoB,CAC9C,GAAG,CAAC,KAAK,EACT,GAAG,CAAC,aAAa,CAClB,CAAC;YACF,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;QACvC,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,sBAAsB,EAAE,GAAG,EAAE;QACpC,EAAE,CAAC,yDAAyD,EAAE,KAAK,IAAI,EAAE;YACvE,MAAM,GAAG,GAA4B,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC;YACzD,WAAW,CAAC,oBAAkC,CAAC,iBAAiB,CAAC;gBAChE,OAAO,EAAE,IAAI;aACd,CAAC,CAAC;YAEH,MAAM,MAAM,GAAG,MAAM,UAAU,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YAC1D,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC,oBAAoB,CAAC,SAAS,CAAC,CAAC;YACzE,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;QAC5C,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,sBAAsB,EAAE,GAAG,EAAE;QACpC,EAAE,CAAC,kEAAkE,EAAE,KAAK,IAAI,EAAE;YAChF,MAAM,GAAG,GAA4B;gBACnC,KAAK,EAAE,SAAS;gBAChB,KAAK,EAAE,OAAO;gBACd,WAAW,EAAE,SAAS;aACvB,CAAC;YACD,WAAW,CAAC,oBAAkC,CAAC,iBAAiB,CAAC;gBAChE,OAAO,EAAE,IAAI;aACd,CAAC,CAAC;YAEH,MAAM,MAAM,GAAG,MAAM,UAAU,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YAC1D,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC,oBAAoB,CAC3D,SAAS,EACT,OAAO,EACP,SAAS,CACV,CAAC;YACF,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;QAC5C,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE;QAC9B,EAAE,CAAC,gFAAgF,EAAE,KAAK,IAAI,EAAE;YAC9F,MAAM,GAAG,GAAG;gBACV,IAAI,EAAE;oBACJ,EAAE,EAAE,GAAG;oBACP,MAAM,EAAE,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC;oBAC9B,WAAW,EAAE,WAAW;oBACxB,MAAM,EAAE,CAAC,EAAE,KAAK,EAAE,WAAW,EAAE,CAAC;oBAChC,QAAQ,EAAE,QAAQ;iBACnB;aAC8C,CAAC;YAElD,MAAM,GAAG,GAAG;gBACV,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;gBACjB,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE;aACO,CAAC;YAEzB,MAAM,kBAAkB,GAAG;gBACzB,aAAa,EAAE,qBAAqB;gBACpC,KAAK,EAAE,oBAAoB;gBAC3B,IAAI,EAAE;oBACJ,EAAE,EAAE,WAAW;oBACf,KAAK,EAAE,SAAS;oBAChB,IAAI,EAAE,WAAW;iBAClB;aACF,CAAC;YAED,WAAW,CAAC,kBAAgC,CAAC,iBAAiB,CAC7D,kBAAkB,CACnB,CAAC;YAEF,MAAM,UAAU,CAAC,cAAc,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;YAE1C,wDAAwD;YACxD,MAAM,CAAC,WAAW,CAAC,kBAAkB,CAAC,CAAC,oBAAoB,CAAC;gBAC1D,EAAE,EAAE,GAAG;gBACP,MAAM,EAAE,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC;gBAC9B,WAAW,EAAE,WAAW;gBACxB,MAAM,EAAE,CAAC,EAAE,KAAK,EAAE,WAAW,EAAE,CAAC;gBAChC,QAAQ,EAAE,QAAQ;aACnB,CAAC,CAAC;YAEH,yBAAyB;YACzB,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,oBAAoB,CACrC,cAAc,EACd,qBAAqB,EACrB;gBACE,QAAQ,EAAE,KAAK;gBACf,MAAM,EAAE,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY;gBAC7C,QAAQ,EAAE,QAAQ;gBAClB,IAAI,EAAE,eAAe;gBACrB,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI;aAChC,CACF,CAAC;YAEF,yBAAyB;YACzB,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,oBAAoB,CACnC,MAAM,CAAC,gBAAgB,CAAC;gBACtB,OAAO,EAAE,IAAI;gBACb,OAAO,EAAE,SAAS;gBAClB,IAAI,EAAE;oBACJ,IAAI,EAAE,kBAAkB,CAAC,IAAI;oBAC7B,YAAY,EAAE,oBAAoB;iBACnC;aACF,CAAC,CACH,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,4DAA4D,EAAE,KAAK,IAAI,EAAE;YAC1E,MAAM,GAAG,GAAG;gBACV,IAAI,EAAE;oBACJ,EAAE,EAAE,GAAG;oBACP,MAAM,EAAE,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC;oBAC9B,WAAW,EAAE,WAAW;oBACxB,MAAM,EAAE,CAAC,EAAE,KAAK,EAAE,WAAW,EAAE,CAAC;oBAChC,QAAQ,EAAE,QAAQ;iBACnB;aAC8C,CAAC;YAElD,MAAM,GAAG,GAAG,EAAc,CAAC;YAE1B,WAAW,CAAC,kBAAgC,CAAC,iBAAiB,CAAC;gBAC9D,KAAK,EAAE,oBAAoB;gBAC3B,aAAa,EAAE,SAAS;gBACxB,IAAI,EAAE,EAAE,EAAE,EAAE,WAAW,EAAE;aAC1B,CAAC,CAAC;YAEH,MAAM,MAAM,CAAC,UAAU,CAAC,cAAc,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAC/D,0BAAiB,CAClB,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,2DAA2D,EAAE,KAAK,IAAI,EAAE;YACzE,MAAM,GAAG,GAAG;gBACV,IAAI,EAAE;oBACJ,EAAE,EAAE,GAAG;oBACP,MAAM,EAAE,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC;oBAC9B,WAAW,EAAE,WAAW;oBACxB,MAAM,EAAE,CAAC,EAAE,KAAK,EAAE,WAAW,EAAE,CAAC;oBAChC,QAAQ,EAAE,QAAQ;iBACnB;aAC8C,CAAC;YAElD,MAAM,GAAG,GAAG,EAAc,CAAC;YAE1B,WAAW,CAAC,kBAAgC,CAAC,iBAAiB,CAAC;gBAC9D,KAAK,EAAE,SAAS;gBAChB,aAAa,EAAE,qBAAqB;gBACpC,IAAI,EAAE,EAAE,EAAE,EAAE,WAAW,EAAE;aAC1B,CAAC,CAAC;YAEH,MAAM,MAAM,CAAC,UAAU,CAAC,cAAc,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAC/D,0BAAiB,CAClB,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,mDAAmD,EAAE,KAAK,IAAI,EAAE;YACjE,MAAM,GAAG,GAAG;gBACV,IAAI,EAAE;oBACJ,EAAE,EAAE,GAAG;oBACP,MAAM,EAAE,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC;oBAC9B,WAAW,EAAE,WAAW;oBACxB,MAAM,EAAE,CAAC,EAAE,KAAK,EAAE,WAAW,EAAE,CAAC;oBAChC,QAAQ,EAAE,QAAQ;iBACnB;aAC8C,CAAC;YAElD,MAAM,GAAG,GAAG,EAAc,CAAC;YAE1B,WAAW,CAAC,kBAAgC,CAAC,iBAAiB,CAAC;gBAC9D,KAAK,EAAE,oBAAoB;gBAC3B,aAAa,EAAE,qBAAqB;gBACpC,IAAI,EAAE,SAAS;aAChB,CAAC,CAAC;YAEH,MAAM,MAAM,CAAC,UAAU,CAAC,cAAc,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAC/D,0BAAiB,CAClB,CAAC;QACJ,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,cAAc,EAAE,GAAG,EAAE;QAC5B,EAAE,CAAC,+EAA+E,EAAE,KAAK,IAAI,EAAE;YAC7F,MAAM,GAAG,GAAG;gBACV,OAAO,EAAE,EAAE,aAAa,EAAE,cAAc,EAAE;aACqB,CAAC;YAEjE,WAAW,CAAC,YAA0B,CAAC,iBAAiB,CAAC;gBACxD,YAAY,EAAE,kBAAkB;aACjC,CAAC,CAAC;YAEH,MAAM,MAAM,GAAG,MAAM,UAAU,CAAC,YAAY,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC;YAE7D,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC,oBAAoB,CACnD,SAAS,EACT,cAAc,CACf,CAAC;YACF,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,CACpB,MAAM,CAAC,gBAAgB,CAAC;gBACtB,OAAO,EAAE,IAAI;gBACb,OAAO,EAAE,8BAA8B;gBACvC,IAAI,EAAE,MAAM,CAAC,gBAAgB,CAAC;oBAC5B,YAAY,EAAE,kBAAkB;iBACjC,CAAC;aACH,CAAC,CACH,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,4DAA4D,EAAE,KAAK,IAAI,EAAE;YAC1E,MAAM,GAAG,GAAG;gBACV,OAAO,EAAE,EAAE;aACU,CAAC;YAExB,MAAM,MAAM,CAAC,UAAU,CAAC,YAAY,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CACnE,0BAAiB,CAClB,CAAC;QACJ,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","names":[],"sources":["/home/omar/Desktop/Protofolio_without_redis/src/auth/auth.controller.spec.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-unsafe-assignment */\n/* eslint-disable @typescript-eslint/no-unsafe-argument */\n/* eslint-disable @typescript-eslint/no-unsafe-member-access */\n/* eslint-disable @typescript-eslint/unbound-method */\nimport { Test, TestingModule } from \"@nestjs/testing\";\nimport { ThrottlerModule } from \"@nestjs/throttler\";\nimport { AuthController } from \"./auth.controller\";\nimport { AuthService } from \"./auth.service\";\nimport {\n  RegisterHalfDto,\n  RegisterFullDto,\n  RegisterCompleteDto,\n  LoginDto,\n  PasswordResetRequestDto,\n  PasswordResetConfirmDto,\n} from \"./Dto/main_auth.dto\";\nimport { Request, Response } from \"express\";\nimport { NotFoundException } from \"@nestjs/common\";\nimport { GoogleProfile } from \"./GoogleProfile\";\nimport { ConfigService } from \"@nestjs/config\";\n\ndescribe(\"AuthController\", () => {\n  let controller: AuthController;\n  let authService: AuthService;\n\n  beforeEach(async () => {\n    const module: TestingModule = await Test.createTestingModule({\n      imports: [\n        ThrottlerModule.forRoot({\n          throttlers: [{ ttl: 60, limit: 10 }],\n        }),\n      ],\n      controllers: [AuthController],\n      providers: [\n        {\n          provide: AuthService,\n          useValue: {\n            register_half: jest.fn(),\n            register_full: jest.fn(),\n            register_complete: jest.fn(),\n            login: jest.fn(),\n            log_out: jest.fn(),\n            requestPasswordReset: jest.fn(),\n            confirmPasswordReset: jest.fn(),\n            validateGoogleUser: jest.fn(),\n            update_token: jest.fn(),\n          },\n        },\n        {\n          provide: ConfigService,\n          useValue: {\n            get: jest.fn(),\n          },\n        },\n      ],\n    }).compile();\n\n    controller = module.get<AuthController>(AuthController);\n    authService = module.get<AuthService>(AuthService);\n  });\n\n  it(\"should be defined\", () => {\n    expect(controller).toBeDefined();\n  });\n\n  describe(\"register_half\", () => {\n    it(\"should call authService.register_half with correct email and IP\", async () => {\n      const dto: RegisterHalfDto = { email: \"test@example.com\" };\n      const req = { ip: \"127.0.0.1\", socket: {} } as Request;\n      (authService.register_half as jest.Mock).mockResolvedValue({\n        success: true,\n      });\n\n      const result = await controller.register_half(dto, req);\n      expect(authService.register_half).toHaveBeenCalledWith(\n        \"test@example.com\",\n        \"127.0.0.1\",\n      );\n      expect(result).toEqual({ success: true });\n    });\n  });\n\n  describe(\"register_full\", () => {\n    it(\"should call authService.register_full with correct params\", async () => {\n      const dto: RegisterFullDto = { email: \"a@b.com\", code: \"123456\" };\n      const req = { ip: \"1.1.1.1\", socket: {} } as Request;\n      (authService.register_full as jest.Mock).mockResolvedValue({\n        success: true,\n      });\n\n      const result = await controller.register_full(dto, req);\n      expect(authService.register_full).toHaveBeenCalledWith(\n        \"a@b.com\",\n        \"123456\",\n        \"1.1.1.1\",\n      );\n      expect(result).toEqual({ success: true });\n    });\n  });\n  describe(\"register_complete\", () => {\n    let mockResponse: any;\n\n    beforeEach(() => {\n      mockResponse = {\n        cookie: jest.fn(),\n        json: jest.fn(), // أضف هذه\n        status: jest.fn().mockReturnThis(), // وأضف هذه في حال كان في res.status()\n      };\n    });\n\n    it(\"should call authService.register_complete with correct params and return success\", async () => {\n      const dto: RegisterCompleteDto = { email: \"x@y.com\", password: \"pass\" };\n      (authService.register_complete as jest.Mock).mockResolvedValue({\n        refresh_Token: \"refresh-signed-token\",\n        access_token: \"signed-token\",\n      });\n\n      await controller.register_complete(dto, mockResponse);\n\n      expect(authService.register_complete).toHaveBeenCalledWith(\n        \"x@y.com\",\n        \"pass\",\n      );\n\n      expect(mockResponse.cookie).toHaveBeenCalledWith(\n        \"refreshToken\",\n        \"refresh-signed-token\",\n        expect.objectContaining({\n          httpOnly: false,\n          secure: true,\n          sameSite: \"strict\",\n          path: \"/update_token\",\n        }),\n      );\n\n      expect(mockResponse.json).toHaveBeenCalledWith(\n        expect.objectContaining({\n          success: true,\n          message: \"success\",\n          data: expect.objectContaining({\n            access_token: \"signed-token\",\n          }),\n        }),\n      );\n    });\n\n    it(\"should throw NotFoundException if refresh_Token is missing\", async () => {\n      const dto: RegisterCompleteDto = { email: \"x@y.com\", password: \"pass\" };\n      (authService.register_complete as jest.Mock).mockResolvedValue({\n        refresh_Token: undefined,\n        access_token: \"signed-token\",\n      });\n\n      await expect(\n        controller.register_complete(dto, mockResponse),\n      ).rejects.toThrow(NotFoundException);\n    });\n\n    it(\"should throw NotFoundException if access_token is missing\", async () => {\n      const dto: RegisterCompleteDto = { email: \"x@y.com\", password: \"pass\" };\n      (authService.register_complete as jest.Mock).mockResolvedValue({\n        refresh_Token: \"refresh-signed-token\",\n        access_token: undefined,\n      });\n\n      await expect(\n        controller.register_complete(dto, mockResponse),\n      ).rejects.toThrow(NotFoundException);\n    });\n  });\n\n  describe(\"login\", () => {\n    it(\"should call authService.login, set cookie, and return access token\", async () => {\n      const dto: LoginDto = { email: \"a@b.com\", password: \"123\" };\n      const req = {\n        ip: \"2.2.2.2\",\n        socket: { remoteAddress: \"2.2.2.2\" },\n      } as unknown as Request;\n\n      const res = {\n        cookie: jest.fn(),\n        json: jest.fn(),\n      } as unknown as Response;\n\n      const mockResult = {\n        access_token: \"access-token-value\",\n        refresh_Token: \"refresh-token-value\",\n      };\n\n      (authService.login as jest.Mock).mockResolvedValue(mockResult);\n\n      await controller.login(dto, req, res);\n\n      // ✅ تحقق أن login اتنادى صح\n      expect(authService.login).toHaveBeenCalledWith(\n        \"a@b.com\",\n        \"123\",\n        \"2.2.2.2\",\n      );\n      // ✅ تحقق من إعداد الكوكي\n      expect(res.cookie).toHaveBeenCalledWith(\n        \"refreshToken\",\n        \"refresh-token-value\",\n        {\n          httpOnly: false,\n          secure: process.env.NODE_ENV === \"production\",\n          sameSite: \"strict\",\n          path: \"/update_token\",\n          maxAge: 7 * 24 * 60 * 60 * 1000,\n        },\n      );\n\n      // ✅ تحقق من استدعاء res.json بالرد الصحيح\n      expect(res.json).toHaveBeenCalledWith(\n        expect.objectContaining({\n          success: true,\n          message: \"success\",\n          data: { access_token: \"access-token-value\" },\n        }),\n      );\n    });\n\n    it(\"should throw NotFoundException if refresh_Token is missing\", async () => {\n      const dto: LoginDto = { email: \"a@b.com\", password: \"123\" };\n      const req = {\n        ip: \"1.1.1.1\",\n        socket: { remoteAddress: \"1.1.1.1\" },\n      } as unknown as Request;\n      const res = {} as Response;\n\n      (authService.login as jest.Mock).mockResolvedValue({\n        access_token: \"access-token-value\",\n        refresh_Token: undefined,\n      });\n\n      await expect(controller.login(dto, req, res)).rejects.toThrow(\n        NotFoundException,\n      );\n    });\n\n    it(\"should throw NotFoundException if access_token is missing\", async () => {\n      const dto: LoginDto = { email: \"a@b.com\", password: \"123\" };\n      const req = {\n        ip: \"1.1.1.1\",\n        socket: { remoteAddress: \"1.1.1.1\" },\n      } as unknown as Request;\n      const res = {} as Response;\n\n      (authService.login as jest.Mock).mockResolvedValue({\n        access_token: undefined,\n        refresh_Token: \"refresh-token-value\",\n      });\n\n      await expect(controller.login(dto, req, res)).rejects.toThrow(\n        NotFoundException,\n      );\n    });\n  });\n\n  describe(\"log_out\", () => {\n    it(\"should call authService.log_out and return success\", async () => {\n      const mockResponse = {\n        success: true,\n        message: \"Logged out successfully\",\n      };\n      (authService.log_out as jest.Mock).mockResolvedValue(mockResponse);\n\n      const dto = {\n        email: \"test@example.com\",\n        refresh_token: \"mock_refresh_token\",\n      };\n\n      const result = await controller.log_out(dto);\n\n      expect(authService.log_out).toHaveBeenCalledWith(\n        dto.email,\n        dto.refresh_token,\n      );\n      expect(result).toEqual(mockResponse);\n    });\n  });\n\n  describe(\"requestPasswordReset\", () => {\n    it(\"should call authService.requestPasswordReset with email\", async () => {\n      const dto: PasswordResetRequestDto = { email: \"a@b.com\" };\n      (authService.requestPasswordReset as jest.Mock).mockResolvedValue({\n        success: true,\n      });\n\n      const result = await controller.requestPasswordReset(dto);\n      expect(authService.requestPasswordReset).toHaveBeenCalledWith(\"a@b.com\");\n      expect(result).toEqual({ success: true });\n    });\n  });\n\n  describe(\"confirmPasswordReset\", () => {\n    it(\"should call authService.confirmPasswordReset with correct params\", async () => {\n      const dto: PasswordResetConfirmDto = {\n        email: \"a@b.com\",\n        token: \"token\",\n        newPassword: \"newpass\",\n      };\n      (authService.confirmPasswordReset as jest.Mock).mockResolvedValue({\n        success: true,\n      });\n\n      const result = await controller.confirmPasswordReset(dto);\n      expect(authService.confirmPasswordReset).toHaveBeenCalledWith(\n        \"a@b.com\",\n        \"token\",\n        \"newpass\",\n      );\n      expect(result).toEqual({ success: true });\n    });\n  });\n\n  describe(\"googleCallback\", () => {\n    it(\"should call authService.validateGoogleUser, set cookie, and return ApiResponse\", async () => {\n      const req = {\n        user: {\n          id: \"1\",\n          emails: [{ value: \"a@b.com\" }],\n          displayName: \"Test User\",\n          photos: [{ value: \"photo.jpg\" }],\n          provider: \"google\",\n        },\n      } as unknown as Request & { user: GoogleProfile };\n\n      const res = {\n        cookie: jest.fn(),\n        json: jest.fn(),\n      } as unknown as Response;\n\n      const mockGoogleResponse = {\n        refresh_Token: \"refresh-token-value\",\n        token: \"access-token-value\",\n        user: {\n          id: \"user-uuid\",\n          email: \"a@b.com\",\n          name: \"Test User\",\n        },\n      };\n\n      (authService.validateGoogleUser as jest.Mock).mockResolvedValue(\n        mockGoogleResponse,\n      );\n\n      await controller.googleCallback(req, res);\n\n      // ✅ التحقق من استدعاء validateGoogleUser بالقيم الصحيحة\n      expect(authService.validateGoogleUser).toHaveBeenCalledWith({\n        id: \"1\",\n        emails: [{ value: \"a@b.com\" }],\n        displayName: \"Test User\",\n        photos: [{ value: \"photo.jpg\" }],\n        provider: \"google\",\n      });\n\n      // ✅ تحقق من إعداد الكوكي\n      expect(res.cookie).toHaveBeenCalledWith(\n        \"refreshToken\",\n        \"refresh-token-value\",\n        {\n          httpOnly: false,\n          secure: process.env.NODE_ENV === \"production\",\n          sameSite: \"strict\",\n          path: \"/update_token\",\n          maxAge: 7 * 24 * 60 * 60 * 1000,\n        },\n      );\n\n      // ✅ تحقق من الرد النهائي\n      expect(res.json).toHaveBeenCalledWith(\n        expect.objectContaining({\n          success: true,\n          message: \"success\",\n          data: {\n            user: mockGoogleResponse.user,\n            access_token: \"access-token-value\",\n          },\n        }),\n      );\n    });\n\n    it(\"should throw NotFoundException if refresh_Token is missing\", async () => {\n      const req = {\n        user: {\n          id: \"1\",\n          emails: [{ value: \"a@b.com\" }],\n          displayName: \"Test User\",\n          photos: [{ value: \"photo.jpg\" }],\n          provider: \"google\",\n        },\n      } as unknown as Request & { user: GoogleProfile };\n\n      const res = {} as Response;\n\n      (authService.validateGoogleUser as jest.Mock).mockResolvedValue({\n        token: \"access-token-value\",\n        refresh_Token: undefined,\n        user: { id: \"user-uuid\" },\n      });\n\n      await expect(controller.googleCallback(req, res)).rejects.toThrow(\n        NotFoundException,\n      );\n    });\n\n    it(\"should throw NotFoundException if access token is missing\", async () => {\n      const req = {\n        user: {\n          id: \"1\",\n          emails: [{ value: \"a@b.com\" }],\n          displayName: \"Test User\",\n          photos: [{ value: \"photo.jpg\" }],\n          provider: \"google\",\n        },\n      } as unknown as Request & { user: GoogleProfile };\n\n      const res = {} as Response;\n\n      (authService.validateGoogleUser as jest.Mock).mockResolvedValue({\n        token: undefined,\n        refresh_Token: \"refresh-token-value\",\n        user: { id: \"user-uuid\" },\n      });\n\n      await expect(controller.googleCallback(req, res)).rejects.toThrow(\n        NotFoundException,\n      );\n    });\n\n    it(\"should throw NotFoundException if user is missing\", async () => {\n      const req = {\n        user: {\n          id: \"1\",\n          emails: [{ value: \"a@b.com\" }],\n          displayName: \"Test User\",\n          photos: [{ value: \"photo.jpg\" }],\n          provider: \"google\",\n        },\n      } as unknown as Request & { user: GoogleProfile };\n\n      const res = {} as Response;\n\n      (authService.validateGoogleUser as jest.Mock).mockResolvedValue({\n        token: \"access-token-value\",\n        refresh_Token: \"refresh-token-value\",\n        user: undefined,\n      });\n\n      await expect(controller.googleCallback(req, res)).rejects.toThrow(\n        NotFoundException,\n      );\n    });\n  });\n\n  describe(\"update_token\", () => {\n    it(\"should call authService.update_token with email and refresh_Token from cookie\", async () => {\n      const req = {\n        cookies: { refresh_Token: \"cookie-token\" },\n      } as unknown as Request & { cookies: { refresh_Token?: string } };\n\n      (authService.update_token as jest.Mock).mockResolvedValue({\n        access_token: \"new-access-token\",\n      });\n\n      const result = await controller.update_token(\"a@b.com\", req);\n\n      expect(authService.update_token).toHaveBeenCalledWith(\n        \"a@b.com\",\n        \"cookie-token\",\n      );\n      expect(result).toEqual(\n        expect.objectContaining({\n          success: true,\n          message: \"Token refreshed successfully\",\n          data: expect.objectContaining({\n            access_token: \"new-access-token\",\n          }),\n        }),\n      );\n    });\n\n    it(\"should throw NotFoundException if refresh_Token is missing\", async () => {\n      const req = {\n        cookies: {},\n      } as unknown as Request;\n\n      await expect(controller.update_token(\"a@b.com\", req)).rejects.toThrow(\n        NotFoundException,\n      );\n    });\n  });\n});\n"],"version":3}