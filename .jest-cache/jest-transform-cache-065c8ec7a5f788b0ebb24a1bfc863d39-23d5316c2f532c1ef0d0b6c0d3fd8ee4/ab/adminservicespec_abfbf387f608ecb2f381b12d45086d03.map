{"file":"/home/omar/Desktop/Protofolio_without_redis/src/admin/admin.service.spec.ts","mappings":"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","names":[],"sources":["/home/omar/Desktop/Protofolio_without_redis/src/admin/admin.service.spec.ts"],"sourcesContent":["import { Test, TestingModule } from \"@nestjs/testing\";\nimport { AdminService } from \"./admin.service\";\nimport { getRepositoryToken } from \"@nestjs/typeorm\";\nimport { User } from \"../entities/User.entity\";\nimport { Cart } from \"../entities/Cart.entity\";\nimport { Product } from \"../entities/Product.entity\";\nimport { Review } from \"../entities/Review.entity\";\nimport { CartItem } from \"../entities/Cart_Item.entity\";\nimport { ObjectLiteral, Repository } from \"typeorm\";\nimport {\n  BadRequestException,\n  HttpException,\n  InternalServerErrorException,\n  NotFoundException,\n} from \"@nestjs/common\";\n\ntype MockType<T> = {\n  [P in keyof T]?: jest.Mock<unknown>;\n};\n\nconst repositoryMockFactory = <T extends ObjectLiteral = any>(): MockType<\n  Repository<T>\n> => ({\n  find: jest.fn(),\n  findOne: jest.fn(),\n  findOneBy: jest.fn(),\n  create: jest.fn(),\n  save: jest.fn(),\n  update: jest.fn(),\n  remove: jest.fn(),\n});\n\ndescribe(\"AdminService\", () => {\n  let moduleRef: TestingModule;\n  let service: AdminService;\n  let userRepo: MockType<Repository<User>>;\n  let cartRepo: MockType<Repository<Cart>>;\n  let productRepo: MockType<Repository<Product>>;\n  let cartItemRepo: MockType<Repository<CartItem>>;\n\n  beforeEach(async () => {\n    moduleRef = await Test.createTestingModule({\n      providers: [\n        AdminService,\n        {\n          provide: getRepositoryToken(User),\n          useFactory: repositoryMockFactory,\n        },\n        {\n          provide: getRepositoryToken(Cart),\n          useFactory: repositoryMockFactory,\n        },\n        {\n          provide: getRepositoryToken(Product),\n          useFactory: repositoryMockFactory,\n        },\n        {\n          provide: getRepositoryToken(Review),\n          useFactory: repositoryMockFactory,\n        },\n        {\n          provide: getRepositoryToken(CartItem),\n          useFactory: repositoryMockFactory,\n        },\n      ],\n    }).compile();\n\n    service = moduleRef.get<AdminService>(AdminService);\n    userRepo = moduleRef.get(getRepositoryToken(User));\n    cartRepo = moduleRef.get(getRepositoryToken(Cart));\n    productRepo = moduleRef.get(getRepositoryToken(Product));\n    cartItemRepo = moduleRef.get(getRepositoryToken(CartItem));\n  });\n\n  it(\"should be defined\", () => {\n    expect(service).toBeDefined();\n  });\n\n  describe(\"FindLimitUser\", () => {\n    it(\"should return users based on take and skip\", async () => {\n      const mockUsers: User[] = [\n        { id: \"1\", name: \"User1\" } as User,\n        { id: \"2\", name: \"User2\" } as User,\n      ];\n      (userRepo.find as jest.Mock).mockResolvedValue(mockUsers);\n\n      const result = await service.FindLimitUser(2, 0);\n      expect(result).toEqual(mockUsers);\n      expect(userRepo.find).toHaveBeenCalledWith({ skip: 0, take: 2 });\n    });\n\n    it(\"should throw an error if find fails\", async () => {\n      (userRepo.find as jest.Mock).mockRejectedValue(new Error(\"DB error\"));\n      await expect(service.FindLimitUser(2, 0)).rejects.toThrow(\n        \"Failed to create user: Error: DB error\",\n      );\n    });\n  });\n\n  describe(\"FindUser\", () => {\n    it(\"should return a user if found\", async () => {\n      const mockUser: User = { id: \"1\", name: \"User1\" } as User;\n      (userRepo.findOne as jest.Mock).mockResolvedValue(mockUser);\n\n      const result = await service.FindUser(\"1\");\n      expect(result).toEqual(mockUser);\n      expect(userRepo.findOne).toHaveBeenCalledWith({ where: { id: \"1\" } });\n    });\n\n    it(\"should throw NotFoundException if user not found\", async () => {\n      (userRepo.findOne as jest.Mock).mockResolvedValue(null);\n      await expect(service.FindUser(\"1\")).rejects.toThrow(NotFoundException);\n    });\n\n    it(\"should throw an error if findOne fails\", async () => {\n      (userRepo.findOne as jest.Mock).mockRejectedValue(new Error(\"DB error\"));\n      await expect(service.FindUser(\"1\")).rejects.toThrow(\n        \"Failed to create user: Error: DB error\",\n      );\n    });\n  });\n\n  describe(\"CreateUser\", () => {\n    it(\"should create a user and a cart\", async () => {\n      const userData: User = {\n        name: \"User1\",\n        email: \"user1@example.com\",\n        password: \"pass123\",\n        provider: \"local\",\n        role: \"user\",\n        isVerified: true,\n        googleId: null,\n      } as unknown as User;\n\n      const createdUser: User = { ...userData, id: \"1\" } as User;\n      const createdCart: Cart = { id: \"1\", user: createdUser } as Cart;\n\n      (userRepo.create as jest.Mock).mockReturnValue(userData);\n      (userRepo.save as jest.Mock).mockResolvedValue(createdUser);\n      (cartRepo.create as jest.Mock).mockReturnValue({ user: createdUser });\n      (cartRepo.save as jest.Mock).mockResolvedValue(createdCart);\n\n      const result = await service.CreateUser(userData);\n\n      expect(result).toEqual(createdUser);\n      expect(userRepo.create).toHaveBeenCalledWith({\n        name: userData.name,\n        email: userData.email,\n        password: userData.password,\n        provider: userData.provider,\n        role: userData.role,\n        isVerified: userData.isVerified,\n        googleId: userData.googleId,\n      });\n      expect(userRepo.save).toHaveBeenCalledWith(userData);\n      expect(cartRepo.create).toHaveBeenCalledWith({ user: createdUser });\n      expect(cartRepo.save).toHaveBeenCalledWith({ user: createdUser });\n    });\n\n    it(\"should throw an error if UserRepo.save fails\", async () => {\n      const userData: User = { name: \"User1\" } as User;\n      (userRepo.create as jest.Mock).mockReturnValue(userData);\n      (userRepo.save as jest.Mock).mockRejectedValue(new Error(\"DB error\"));\n\n      await expect(service.CreateUser(userData)).rejects.toThrow(\n        \"Failed to create user: Error: DB error\",\n      );\n    });\n\n    it(\"should throw an error if CartRepo.save fails\", async () => {\n      const userData: User = { name: \"User1\" } as User;\n      const createdUser: User = { ...userData, id: \"1\" } as User;\n\n      (userRepo.create as jest.Mock).mockReturnValue(userData);\n      (userRepo.save as jest.Mock).mockResolvedValue(createdUser);\n      (cartRepo.create as jest.Mock).mockReturnValue({ user: createdUser });\n      (cartRepo.save as jest.Mock).mockRejectedValue(new Error(\"Cart error\"));\n\n      await expect(service.CreateUser(userData)).rejects.toThrow(\n        \"Failed to create user: Error: Cart error\",\n      );\n    });\n  });\n  describe(\"UpdateUser\", () => {\n    it(\"should update user successfully\", async () => {\n      const userId = \"1\";\n      const existingUser = { id: userId, name: \"OldName\" } as User;\n      const updatedData = { name: \"NewName\" };\n\n      (userRepo.findOne as jest.Mock).mockResolvedValue(existingUser);\n      (userRepo.update as jest.Mock).mockResolvedValue({ affected: 1 });\n\n      const result = await service.UpdateUser(userId, updatedData);\n\n      expect(result).toBe(\"ok\");\n      expect(userRepo.findOne).toHaveBeenCalledWith({ where: { id: userId } });\n      expect(userRepo.update).toHaveBeenCalledWith(userId, updatedData);\n    });\n\n    it(\"should throw NotFoundException if user not found\", async () => {\n      const userId = \"1\";\n      (userRepo.findOne as jest.Mock).mockResolvedValue(null);\n\n      await expect(service.UpdateUser(userId, { name: \"X\" })).rejects.toThrow(\n        NotFoundException,\n      );\n    });\n\n    it(\"should throw error if update fails\", async () => {\n      const userId = \"1\";\n      const existingUser = { id: userId, name: \"OldName\" } as User;\n\n      (userRepo.findOne as jest.Mock).mockResolvedValue(existingUser);\n      (userRepo.update as jest.Mock).mockRejectedValue(new Error(\"DB error\"));\n\n      await expect(\n        service.UpdateUser(userId, { name: \"FailName\" }),\n      ).rejects.toThrow(\"Failed to Update user: Error: DB error\");\n    });\n  });\n  describe(\"DeleteUser\", () => {\n    it(\"should throw BadRequestException if id is missing\", async () => {\n      await expect(service.DeleteUser(\"\")).rejects.toThrow(BadRequestException);\n    });\n\n    it(\"should throw NotFoundException if user not found\", async () => {\n      (userRepo.findOne as jest.Mock).mockResolvedValue(null);\n\n      await expect(service.DeleteUser(\"1\")).rejects.toThrow(NotFoundException);\n      expect(userRepo.findOne).toHaveBeenCalledWith({\n        where: { id: \"1\" },\n        relations: [\"orders\", \"cart\", \"reviews\"],\n      });\n    });\n\n    it(\"should delete user and return confirmation message\", async () => {\n      const mockUser = { id: \"1\", name: \"User1\" } as User;\n      (userRepo.findOne as jest.Mock).mockResolvedValue(mockUser);\n      (userRepo.remove as jest.Mock).mockResolvedValue(undefined);\n\n      const result = await service.DeleteUser(\"1\");\n\n      expect(result).toBe(\"the user deleted\");\n      expect(userRepo.remove).toHaveBeenCalledWith(mockUser);\n    });\n  });\n  describe(\"FindLimitProducts\", () => {\n    it(\"should return products based on take and skip\", async () => {\n      const mockProducts: Product[] = [\n        { id: \"1\", name: \"Product1\" } as Product,\n        { id: \"2\", name: \"Product2\" } as Product,\n      ];\n\n      (productRepo.find as jest.Mock).mockResolvedValue(mockProducts);\n\n      const result = await service.FindLimitProducts(2, 0);\n\n      expect(result).toEqual(mockProducts);\n      expect(productRepo.find).toHaveBeenCalledWith({\n        skip: 0,\n        take: 2,\n        relations: [\"reviews\"],\n      });\n    });\n\n    it(\"should throw an error if repository.find fails\", async () => {\n      (productRepo.find as jest.Mock).mockRejectedValue(new Error(\"DB error\"));\n\n      await expect(service.FindLimitProducts(2, 0)).rejects.toThrow(\n        \"Failed to fetch products: Error: DB error\",\n      );\n    });\n  });\n  describe(\"FindProduct\", () => {\n    it(\"should return a product if found\", async () => {\n      const mockProduct: Product = { id: \"1\", name: \"Product1\" } as Product;\n      (productRepo.findOne as jest.Mock).mockResolvedValue(mockProduct);\n\n      const result = await service.FindProduct(\"1\");\n\n      expect(result).toEqual(mockProduct);\n      expect(productRepo.findOne).toHaveBeenCalledWith({\n        where: { id: \"1\" },\n        relations: [\"reviews\"],\n      });\n    });\n\n    it(\"should throw NotFoundException if product not found\", async () => {\n      (productRepo.findOne as jest.Mock).mockResolvedValue(null);\n\n      await expect(service.FindProduct(\"1\")).rejects.toThrow(NotFoundException);\n    });\n\n    it(\"should rethrow HttpException if caught\", async () => {\n      const httpError = new NotFoundException(\"Some HTTP error\");\n      (productRepo.findOne as jest.Mock).mockRejectedValue(httpError);\n\n      await expect(service.FindProduct(\"1\")).rejects.toThrow(HttpException);\n    });\n\n    it(\"should throw InternalServerErrorException for unknown errors\", async () => {\n      (productRepo.findOne as jest.Mock).mockRejectedValue(\n        new Error(\"DB error\"),\n      );\n\n      await expect(service.FindProduct(\"1\")).rejects.toThrow(\n        InternalServerErrorException,\n      );\n    });\n  });\n  describe(\"CreateProduct\", () => {\n    it(\"should create and return a product successfully\", async () => {\n      const productData: Partial<Product> = {\n        name: \"Test Product\",\n        description: \"Description\",\n        price: 100,\n        stock: 10,\n        categoryId: \"cat1\",\n        images: [\"img1\"],\n      };\n\n      const createdProduct: Product = {\n        id: \"1\",\n        ...productData,\n      } as Product;\n\n      (productRepo.create as jest.Mock).mockReturnValue(productData);\n      (productRepo.save as jest.Mock).mockResolvedValue(createdProduct);\n\n      const result = await service.CreateProduct(productData);\n\n      expect(result).toEqual(createdProduct);\n      expect(productRepo.create).toHaveBeenCalledWith({\n        name: \"Test Product\",\n        description: \"Description\",\n        more_description: undefined,\n        price: 100,\n        stock: 10,\n        categoryId: \"cat1\",\n        images: [\"img1\"],\n      });\n      expect(productRepo.save).toHaveBeenCalledWith(productData);\n    });\n\n    it(\"should throw BadRequestException if required fields are missing\", async () => {\n      const invalidData: Partial<Product> = { name: \"Test\" };\n\n      await expect(service.CreateProduct(invalidData)).rejects.toThrow(\n        BadRequestException,\n      );\n    });\n\n    it(\"should throw Error if ProductRepo.save fails\", async () => {\n      const productData: Partial<Product> = {\n        name: \"Test Product\",\n        description: \"Description\",\n        price: 100,\n        stock: 10,\n      };\n\n      (productRepo.create as jest.Mock).mockReturnValue(productData);\n      (productRepo.save as jest.Mock).mockRejectedValue(new Error(\"DB error\"));\n\n      await expect(service.CreateProduct(productData)).rejects.toThrow(\n        \"Failed to create product: Error: DB error\",\n      );\n    });\n  });\n  describe(\"UpdateProduct\", () => {\n    it(\"should update a product successfully\", async () => {\n      const id = \"1\";\n      const updatedProduct: Partial<Product> = { name: \"Updated Product\" };\n      const existingProduct: Product = {\n        id: \"1\",\n        name: \"Old Product\",\n        description: \"Old\",\n        price: 100,\n        stock: 10,\n      } as Product;\n\n      (productRepo.findOne as jest.Mock).mockResolvedValue(existingProduct);\n      (productRepo.update as jest.Mock).mockResolvedValue({ affected: 1 });\n\n      const result = await service.UpdateProduct(id, updatedProduct);\n\n      expect(result).toBe(\"Product updated successfully\");\n      expect(productRepo.findOne).toHaveBeenCalledWith({ where: { id } });\n      expect(productRepo.update).toHaveBeenCalledWith(id, updatedProduct);\n    });\n\n    it(\"should throw BadRequestException if id is missing\", async () => {\n      await expect(service.UpdateProduct(\"\", {})).rejects.toThrow(\n        BadRequestException,\n      );\n    });\n\n    it(\"should throw NotFoundException if product not found\", async () => {\n      (productRepo.findOne as jest.Mock).mockResolvedValue(null);\n      await expect(service.UpdateProduct(\"1\", {})).rejects.toThrow(\n        NotFoundException,\n      );\n    });\n\n    it(\"should throw Error if update fails unexpectedly\", async () => {\n      const id = \"1\";\n      const updatedProduct: Partial<Product> = { name: \"Updated\" };\n      const existingProduct: Product = { id: \"1\", name: \"Old\" } as Product;\n\n      (productRepo.findOne as jest.Mock).mockResolvedValue(existingProduct);\n      (productRepo.update as jest.Mock).mockRejectedValue(\n        new Error(\"DB error\"),\n      );\n\n      await expect(service.UpdateProduct(id, updatedProduct)).rejects.toThrow(\n        \"Failed to update product: Error: DB error\",\n      );\n    });\n  });\n  describe(\"DeleteProduct\", () => {\n    it(\"should delete product successfully\", async () => {\n      const id = \"1\";\n      const mockProduct: Product = {\n        id,\n        name: \"Test Product\",\n        description: \"Desc\",\n        price: 100,\n        stock: 5,\n      } as Product;\n\n      (productRepo.findOne as jest.Mock).mockResolvedValue(mockProduct);\n      (productRepo.remove as jest.Mock).mockResolvedValue(mockProduct);\n\n      const result = await service.DeleteProduct(id);\n\n      expect(result).toBe(\"Product deleted successfully\");\n      expect(productRepo.findOne).toHaveBeenCalledWith({\n        where: { id },\n        relations: [\"reviews\", \"cartItems\"],\n      });\n      expect(productRepo.remove).toHaveBeenCalledWith(mockProduct);\n    });\n\n    it(\"should throw BadRequestException if id is missing\", async () => {\n      await expect(service.DeleteProduct(\"\")).rejects.toThrow(\n        BadRequestException,\n      );\n    });\n\n    it(\"should throw NotFoundException if product not found\", async () => {\n      (productRepo.findOne as jest.Mock).mockResolvedValue(null);\n      await expect(service.DeleteProduct(\"1\")).rejects.toThrow(\n        NotFoundException,\n      );\n    });\n\n    it(\"should throw Error if remove fails unexpectedly\", async () => {\n      const id = \"1\";\n      const mockProduct: Product = { id, name: \"Test\" } as Product;\n\n      (productRepo.findOne as jest.Mock).mockResolvedValue(mockProduct);\n      (productRepo.remove as jest.Mock).mockRejectedValue(\n        new Error(\"DB error\"),\n      );\n\n      await expect(service.DeleteProduct(id)).rejects.toThrow(\n        \"Failed to delete product: Error: DB error\",\n      );\n    });\n  });\n  describe(\"Find_Cart\", () => {\n    it(\"should return cart if found\", async () => {\n      const id = \"1\";\n      const mockCart: Cart = { id } as Cart;\n      (cartRepo.findOneBy as jest.Mock).mockResolvedValue(mockCart);\n\n      const result = await service.Find_Cart(id);\n\n      expect(result).toEqual(mockCart);\n      expect(cartRepo.findOneBy).toHaveBeenCalledWith({ id });\n    });\n\n    it(\"should throw NotFoundException if cart not found\", async () => {\n      (cartRepo.findOneBy as jest.Mock).mockResolvedValue(null);\n      await expect(service.Find_Cart(\"1\")).rejects.toThrow(NotFoundException);\n    });\n  });\n  describe(\"Find_CartItem\", () => {\n    it(\"should return cart item if found\", async () => {\n      const id = \"1\";\n      const mockCartItem: CartItem = { id } as CartItem;\n      (cartItemRepo.findOneBy as jest.Mock).mockResolvedValue(mockCartItem);\n\n      const result = await service.Find_CartItem(id);\n\n      expect(result).toEqual(mockCartItem);\n      expect(cartItemRepo.findOneBy).toHaveBeenCalledWith({ id });\n    });\n\n    it(\"should throw NotFoundException if cart item not found\", async () => {\n      (cartItemRepo.findOneBy as jest.Mock).mockResolvedValue(null);\n      await expect(service.Find_CartItem(\"1\")).rejects.toThrow(\n        NotFoundException,\n      );\n    });\n  });\n});\n"],"version":3}