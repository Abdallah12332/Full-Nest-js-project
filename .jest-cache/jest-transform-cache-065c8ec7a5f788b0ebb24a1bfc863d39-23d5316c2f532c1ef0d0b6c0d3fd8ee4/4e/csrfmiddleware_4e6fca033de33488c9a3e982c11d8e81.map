{"file":"/home/omar/Desktop/Protofolio_without_redis/src/csrf.middleware.ts","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,2CAA4D;AAC5D,6CAA+B;AAIxB,IAAM,cAAc,GAApB,MAAM,cAAc;IACR,cAAc,GAAG,KAAK,CAAC,OAAO,CAAC;QAC9C,MAAM,EAAE;YACN,QAAQ,EAAE,KAAK;YACf,QAAQ,EAAE,QAAQ;YAClB,MAAM,EAAE,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY;SAC9C;QACD,KAAK,EAAE,CAAC,GAAY,EAAU,EAAE,CAC7B,GAAG,CAAC,OAAO,CAAC,cAAc,CAAY;YACtC,GAAG,CAAC,IAA+B,CAAC,OAAO,CAAC;YAC7C,EAAE;KACL,CAAC,CAAC;IAEH,GAAG,CAAC,GAAY,EAAE,GAAa,EAAE,IAAkB;QACjD,IAAI,CAAC,cAAc,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;IACtC,CAAC;CACF,CAAA;AAhBY,wCAAc;yBAAd,cAAc;IAD1B,IAAA,mBAAU,GAAE;GACA,cAAc,CAgB1B","names":[],"sources":["/home/omar/Desktop/Protofolio_without_redis/src/csrf.middleware.ts"],"sourcesContent":["import { Injectable, NestMiddleware } from \"@nestjs/common\";\nimport * as csurf from \"csurf\";\nimport { Request, Response, NextFunction } from \"express\";\n\n@Injectable()\nexport class CsrfMiddleware implements NestMiddleware {\n  private readonly csrfProtection = csurf.default({\n    cookie: {\n      httpOnly: false,\n      sameSite: \"strict\",\n      secure: process.env.NODE_ENV === \"production\",\n    },\n    value: (req: Request): string =>\n      (req.headers[\"x-csrf-token\"] as string) ||\n      (req.body as Record<string, string>)[\"_csrf\"] ||\n      \"\",\n  });\n\n  use(req: Request, res: Response, next: NextFunction) {\n    this.csrfProtection(req, res, next);\n  }\n}\n"],"version":3}