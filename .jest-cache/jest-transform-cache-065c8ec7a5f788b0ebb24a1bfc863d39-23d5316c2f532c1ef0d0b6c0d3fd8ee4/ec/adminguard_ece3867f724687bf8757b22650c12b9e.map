{"version":3,"names":["cov_1xvp1kxopb","actualCoverage","common_1","s","require","AdminGuard","canActivate","context","f","req","switchToHttp","getRequest","user","b","role","ForbiddenException","exports","__decorate","Injectable"],"sources":["/home/omar/Desktop/Protofolio_without_redis/src/auth/guards/admin.guard.ts"],"sourcesContent":["import {\n  CanActivate,\n  ExecutionContext,\n  Injectable,\n  ForbiddenException,\n} from \"@nestjs/common\";\n\n@Injectable()\nexport class AdminGuard implements CanActivate {\n  canActivate(context: ExecutionContext): boolean {\n    const req = context.switchToHttp().getRequest();\n    const user = req.user;\n\n    if (user && user.role === \"admin\") {\n      return true;\n    }\n    throw new ForbiddenException(\"Admins only\");\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAcM;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAdN,MAAAE,QAAA;AAAA;AAAA,CAAAF,cAAA,GAAAG,CAAA,QAAAC,OAAA;AAKwB;AAAAJ,cAAA,GAAAG,CAAA;AAGjB,IAAME,UAAU,GAAhB,MAAMA,UAAU;EACrBC,WAAWA,CAACC,OAAyB;IAAA;IAAAP,cAAA,GAAAQ,CAAA;IACnC,MAAMC,GAAG;IAAA;IAAA,CAAAT,cAAA,GAAAG,CAAA,QAAGI,OAAO,CAACG,YAAY,EAAE,CAACC,UAAU,EAAE;IAC/C,MAAMC,IAAI;IAAA;IAAA,CAAAZ,cAAA,GAAAG,CAAA,QAAGM,GAAG,CAACG,IAAI;IAAC;IAAAZ,cAAA,GAAAG,CAAA;IAEtB;IAAI;IAAA,CAAAH,cAAA,GAAAa,CAAA,WAAAD,IAAI;IAAA;IAAA,CAAAZ,cAAA,GAAAa,CAAA,WAAID,IAAI,CAACE,IAAI,KAAK,OAAO,GAAE;MAAA;MAAAd,cAAA,GAAAa,CAAA;MAAAb,cAAA,GAAAG,CAAA;MACjC,OAAO,IAAI;IACb,CAAC;IAAA;IAAA;MAAAH,cAAA,GAAAa,CAAA;IAAA;IAAAb,cAAA,GAAAG,CAAA;IACD,MAAM,IAAID,QAAA,CAAAa,kBAAkB,CAAC,aAAa,CAAC;EAC7C;CACD;AAAA;AAAAf,cAAA,GAAAG,CAAA;AAVYa,OAAA,CAAAX,UAAA,GAAAA,UAAA;AAAU;AAAAL,cAAA,GAAAG,CAAA;qBAAVE,UAAU,GAAAY,UAAA,EADtB,IAAAf,QAAA,CAAAgB,UAAU,GAAE,C,EACAb,UAAU,CAUtB","ignoreList":[]}