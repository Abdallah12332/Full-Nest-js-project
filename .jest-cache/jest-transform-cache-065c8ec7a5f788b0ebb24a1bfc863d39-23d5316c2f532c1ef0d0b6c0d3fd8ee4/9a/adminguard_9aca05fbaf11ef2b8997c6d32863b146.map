{"file":"/home/omar/Desktop/Protofolio_without_redis/src/auth/guards/admin.guard.ts","mappings":";;;;;;;;;AAAA,2CAKwB;AAGjB,IAAM,UAAU,GAAhB,MAAM,UAAU;IACrB,WAAW,CAAC,OAAyB;QACnC,MAAM,GAAG,GAAG,OAAO,CAAC,YAAY,EAAE,CAAC,UAAU,EAAE,CAAC;QAChD,MAAM,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC;QAEtB,IAAI,IAAI,IAAI,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,CAAC;YAClC,OAAO,IAAI,CAAC;QACd,CAAC;QACD,MAAM,IAAI,2BAAkB,CAAC,aAAa,CAAC,CAAC;IAC9C,CAAC;CACF,CAAA;AAVY,gCAAU;qBAAV,UAAU;IADtB,IAAA,mBAAU,GAAE;GACA,UAAU,CAUtB","names":[],"sources":["/home/omar/Desktop/Protofolio_without_redis/src/auth/guards/admin.guard.ts"],"sourcesContent":["import {\n  CanActivate,\n  ExecutionContext,\n  Injectable,\n  ForbiddenException,\n} from \"@nestjs/common\";\n\n@Injectable()\nexport class AdminGuard implements CanActivate {\n  canActivate(context: ExecutionContext): boolean {\n    const req = context.switchToHttp().getRequest();\n    const user = req.user;\n\n    if (user && user.role === \"admin\") {\n      return true;\n    }\n    throw new ForbiddenException(\"Admins only\");\n  }\n}\n"],"version":3}