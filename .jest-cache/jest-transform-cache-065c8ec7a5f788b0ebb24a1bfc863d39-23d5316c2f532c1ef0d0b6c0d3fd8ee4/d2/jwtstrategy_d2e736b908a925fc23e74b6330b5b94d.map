{"version":3,"names":["cov_2n2tpjdjcz","actualCoverage","common_1","s","require","passport_1","passport_jwt_1","config_1","JwtStrategy","PassportStrategy","Strategy","configservice","constructor","f","secret","get","b","Error","jwtFromRequest","ExtractJwt","fromAuthHeaderAsBearerToken","ignoreExpiration","secretOrKey","issuer","validate","payload","sub","username","role","exports","__decorate","Injectable","ConfigService","_a","Object"],"sources":["/home/omar/Desktop/Protofolio_without_redis/src/auth/jwt.strategy.ts"],"sourcesContent":["import { Injectable } from \"@nestjs/common\";\nimport { PassportStrategy } from \"@nestjs/passport\";\nimport { ExtractJwt, Strategy } from \"passport-jwt\";\nimport { JwtPayload } from \"./JwtPayload\";\nimport { ConfigService } from \"@nestjs/config\";\n\n@Injectable()\nexport class JwtStrategy extends PassportStrategy(Strategy) {\n  constructor(private readonly configservice: ConfigService) {\n    const secret = configservice.get<string>(\"JWT_SECRET\");\n    if (!secret) throw new Error(\"JWT_SECRET is not defined in enviroment\");\n\n    super({\n      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\n      ignoreExpiration: false,\n      secretOrKey: secret,\n      issuer: \"Protofolio\",\n    });\n  }\n\n  validate(payload: JwtPayload) {\n    return { sub: payload.sub, username: payload.username, role: payload.role };\n  }\n}\n"],"mappings":"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","ignoreList":[]}